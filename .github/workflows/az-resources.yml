name: Criar Variável de Ambiente
on: [push]

jobs:
  criar-variavel:
    runs-on: ubuntu-latest
    steps:

      # - name: Creating Release Notes   
      #   shell: bash     
      #   run: |       
      #     echo "az_resources=$(curl -H "Content-Type: application/json" \
      #       -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldCIsImlzcyI6Imh0dHBzOi8vc3RzLndpbmRvd3MubmV0LzgxODcwNGZiLThmZjMtNGQyOC05YTA1LWY1NDJjOTFhYmU0Ni8iLCJpYXQiOjE2ODEyNDEzNTAsIm5iZiI6MTY4MTI0MTM1MCwiZXhwIjoxNjgxMjQ2MTgwLCJhY3IiOiIxIiwiYWlvIjoiQVZRQXEvOFRBQUFBL1g5cWFrdGswSXJSd3BjUHJBOUg1NUlTZGp3bXM1MXBuYy9NdWRic2RENEJZZHMwM0J1dFErVHNCdkF3bWd0K1F1M2ZxRDZMVVJyZ3FNN0t4T1Z5MjhjMVB4bW1qbGNmTWMvc1JNZUw1bzA9IiwiYW1yIjpbInB3ZCIsIm1mYSJdLCJhcHBpZCI6IjE4ZmJjYTE2LTIyMjQtNDVmNi04NWIwLWY3YmYyYjM5YjNmMyIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoiU2FtcGFpbyIsImdpdmVuX25hbWUiOiJSZW5hbiIsImdyb3VwcyI6WyJlZGE4NTM4NC0wNmU0LTRlYjEtYTI1ZC0yOGNhYTYwNTA5YzEiLCI0NjlhZmZkZC1hZTQ4LTRiM2YtYTM4NS0yYmFjMWExYjQ5MzUiXSwiaXBhZGRyIjoiMTg5LjEwNi43OC4zNiIsIm5hbWUiOiJSZW5hbiBTYW1wYWlvIiwib2lkIjoiODllZTMyMWQtOTVhZS00ODdhLTlmZmQtYWUwNmU0MzRkMzY4IiwicHVpZCI6IjEwMDMyMDAxQTI5NTg3RTMiLCJyaCI6IjAuQVVVQS13U0hnZk9QS0UyYUJmVkN5UnEtUmtaSWYza0F1dGRQdWtQYXdmajJNQk5GQU1NLiIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6IjJXak1hTVFnQmlkZTY0LWQ3eFY0Wk1PNjdBOXJjR2I2RkpmRk00VDJSVUEiLCJ0aWQiOiI4MTg3MDRmYi04ZmYzLTRkMjgtOWEwNS1mNTQyYzkxYWJlNDYiLCJ1bmlxdWVfbmFtZSI6InJlbmFuc2FtcGFpb0BhbGV4YW5kZXJjb25jZWljYW9ldmxvczR1Lm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6InJlbmFuc2FtcGFpb0BhbGV4YW5kZXJjb25jZWljYW9ldmxvczR1Lm9ubWljcm9zb2Z0LmNvbSIsInV0aSI6ImFZb2lJWmpSRGs2R0NxM29ydzhMQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjRhNWQ4ZjY1LTQxZGEtNGRlNC04OTY4LWUwMzViNjUzMzljZiIsImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfdGNkdCI6MTU3OTU3ODQ5NH0.UTcXFvywRn-1OMJymrpG_k_NqHzhwDA_teDdwShYd9GTwTBjRF1tnwI7mlKo_uKkNJmSBNLcpGE2nCLKwcUPQlKOqgqn1xJ7xAL2CQQmc2S-TIbta-OK5M9hqWFc_mAWsXuenMaZjDK6wlhSlFURWHPupbGNALvSpmR4HDdQpiJiz_kw2KphJyaeCmsjZObozCLO3r9vNhJMQOm2ElI9N7DJGc4bC8ohghEsvw4IKnIWbigdxOONRYFnWCkAE8ymcciyFXXCKCBeaRB_6wIjS5LkjechA9Xe0LAULxu0xyqzsD1rnbX7ic7TJOqsteZJpFkP4yYbk9M6ig3NBd0GAg" \
      #       https://management.azure.com/subscriptions/0b84aeb3-3723-42d4-b77a-6d8b2bb3353a/resources?api-version=2021-04-01)" >> $GITHUB_ENV

      - name: Creating Release Notes   
        shell: bash     
        run: |       
          curl -o response.json -H "Content-Type: application/json" \
            -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldCIsImlzcyI6Imh0dHBzOi8vc3RzLndpbmRvd3MubmV0LzgxODcwNGZiLThmZjMtNGQyOC05YTA1LWY1NDJjOTFhYmU0Ni8iLCJpYXQiOjE2ODEzMjY1MTUsIm5iZiI6MTY4MTMyNjUxNSwiZXhwIjoxNjgxMzMxNDQwLCJhY3IiOiIxIiwiYWlvIjoiQVZRQXEvOFRBQUFBWndoeTRyaGt2VFhmbVZBbjJrU00vQ3FyTW1DNVZ1RjFLUDc1eWpWaktMcGNJWFdJcXBIK2J3OG1uQ0ZwQWRMeUNXRTkvVDZmQzVoSEg1UkI1cEJjdVNEMklEVFYvUjFMaEpzWVVlcThwS1U9IiwiYW1yIjpbInB3ZCIsIm1mYSJdLCJhcHBpZCI6IjE4ZmJjYTE2LTIyMjQtNDVmNi04NWIwLWY3YmYyYjM5YjNmMyIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoiU2FtcGFpbyIsImdpdmVuX25hbWUiOiJSZW5hbiIsImdyb3VwcyI6WyJlZGE4NTM4NC0wNmU0LTRlYjEtYTI1ZC0yOGNhYTYwNTA5YzEiLCI0NjlhZmZkZC1hZTQ4LTRiM2YtYTM4NS0yYmFjMWExYjQ5MzUiXSwiaXBhZGRyIjoiMTg5LjEwNi43OC4zNiIsIm5hbWUiOiJSZW5hbiBTYW1wYWlvIiwib2lkIjoiODllZTMyMWQtOTVhZS00ODdhLTlmZmQtYWUwNmU0MzRkMzY4IiwicHVpZCI6IjEwMDMyMDAxQTI5NTg3RTMiLCJyaCI6IjAuQVVVQS13U0hnZk9QS0UyYUJmVkN5UnEtUmtaSWYza0F1dGRQdWtQYXdmajJNQk5GQU1NLiIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6IjJXak1hTVFnQmlkZTY0LWQ3eFY0Wk1PNjdBOXJjR2I2RkpmRk00VDJSVUEiLCJ0aWQiOiI4MTg3MDRmYi04ZmYzLTRkMjgtOWEwNS1mNTQyYzkxYWJlNDYiLCJ1bmlxdWVfbmFtZSI6InJlbmFuc2FtcGFpb0BhbGV4YW5kZXJjb25jZWljYW9ldmxvczR1Lm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6InJlbmFuc2FtcGFpb0BhbGV4YW5kZXJjb25jZWljYW9ldmxvczR1Lm9ubWljcm9zb2Z0LmNvbSIsInV0aSI6Ik9ERzROSERZSjBXRDdtMXp3aEYzQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjRhNWQ4ZjY1LTQxZGEtNGRlNC04OTY4LWUwMzViNjUzMzljZiIsImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfdGNkdCI6MTU3OTU3ODQ5NH0.IkAfG2ep0FybGVcgnCksqj7roWo-kRioM7Pt62Mx6A6boYuzI-eDMxfvZgsLIPLOfdz_fNOZnovipwty_sCXLL2agWqXgdpIuqTeU2-NtuXuzV7DddbQFDa3l9SrbMG7jOFEkXfKRjaNXCBYS0nIv-WBu7FB7UUK57gWFTqBzloBA2CPrbOixWfdyhzsmi74uLSw-LCubfH7uGlrBIhN80-APZJ5CgiERxZEtNeAqIDPj4qM8riesIncYRrFC-6TX-Kh6aGrPPovuBcwsfDV6a7N7XnJ3ej-cnCO5UlKY4x4x4IQYEoFmBuIKlcSEAr7PMNWqUbghqGQvgnoKyHs2Q" \
            https://management.azure.com/subscriptions/0b84aeb3-3723-42d4-b77a-6d8b2bb3353a/resources?api-version=2021-04-01]
          git add response.json
          git commit -m "Adicionando arquivo com resposta da requisição GET"
          git push origin master

      # - name: Creating Release Notes   
      #   shell: bash     
      #   run: |       
      #     # Convert JSON object to string using jq
      #     my_json_stringified=$(echo ${{ env.az_resources }} | jq -r .)
      #     # Print the string
      #     echo $my_json_stringified
  
      # - name: Creating Release Notes        
      #   run: |       
      #     curl -L \
      #       -X PATCH \
      #       -H "Accept: application/vnd.github+json" \
      #       -H "Authorization: Bearer ${{ secrets.SECRET }}"\
      #       -H "X-GitHub-Api-Version: 2022-11-28" \
      #       https://api.github.com/repos/DevOps-Renan/devops_infrastructure_library/actions/variables/AZURE_RESOURCES_JSON \
      #       -d '{"name":"AZURE_RESOURCES_JSON","value":'${{ env.env.az_resources}}'}'

